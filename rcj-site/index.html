<!doctype html>
<html lang="en" class="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SpaceFlix â€¢ Stream & Shop</title>
  <meta name="color-scheme" content="dark" />
  <style>
    :root{
      --bg:#05060a; --panel:rgba(255,255,255,.04); --border:rgba(255,255,255,.12);
      --text:#fff; --muted:rgba(255,255,255,.7);
      --indigo:#6366f1; --cyan:#06b6d4; --pink:#db2777;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{margin:0;font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu; background:var(--bg); color:var(--text);}
    a{color:var(--text);text-decoration:none}
    button{font:inherit}
    .container{max-width:1200px;margin:0 auto;padding:1.25rem}
    .navbar{position:sticky;top:0;z-index:30;height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 1rem;
      background:rgba(0,0,0,.55);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
    .nav-left{display:flex;align-items:center;gap:.75rem}
    .brand{font-weight:700;letter-spacing:.08em}
    .nav-link{opacity:.8}
    .nav-link:hover{opacity:1}
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .9rem;border-radius:.5rem;border:1px solid transparent;
      background:var(--indigo);color:#fff;cursor:pointer;transition:transform .06s ease, background .2s ease}
    .btn:active{transform:translateY(1px)}
    .btn-ghost{background:transparent;border-color:var(--border)}
    .badge{display:inline-block;padding:.15rem .45rem;background:var(--panel);border:1px solid var(--border);border-radius:.35rem;font-size:.75rem;color:var(--muted)}
    .hero{position:relative;aspect-ratio:21/9;border:1px solid var(--border);border-radius:12px;overflow:hidden}
    .hero-slide{position:absolute;inset:0;display:grid;place-items:end; padding:2rem; transition:opacity 600ms ease}
    .slide0{background:radial-gradient(1200px 600px at 10% 10%, rgba(99,102,241,.25), transparent), radial-gradient(900px 480px at 80% 30%, rgba(6,182,212,.2), transparent)}
    .slide1{background:radial-gradient(900px 540px at 15% 20%, rgba(219,39,119,.25), transparent), radial-gradient(1000px 500px at 80% 20%, rgba(6,182,212,.18), transparent)}
    .slide2{background:radial-gradient(1000px 520px at 15% 20%, rgba(99,102,241,.25), transparent), radial-gradient(850px 460px at 80% 20%, rgba(219,39,119,.2), transparent)}
    .hero-gradient{position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.7), transparent 60%)}
    .hero h1{font-size:2rem;margin:0 0 .35rem 0}
    .row{margin-top:1.25rem}
    .row h2{margin:0 0 .5rem 0}
    .rail{display:grid;grid-template-columns:repeat(6,minmax(0,1fr));gap:.5rem}
    @media (max-width: 1024px){.rail{grid-template-columns:repeat(3,minmax(0,1fr))}}
    @media (max-width: 640px){.rail{grid-template-columns:repeat(2,minmax(0,1fr))}}
    .card{position:relative;overflow:hidden;border:1px solid var(--border);border-radius:10px;background:var(--panel);min-height:180px;
      transition:transform .25s cubic-bezier(.2,.6,.2,1), box-shadow .25s}
    .card:hover{transform:translateY(-3px); box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .card .label{position:absolute;left:.5rem;bottom:.5rem;font-weight:600;text-shadow:0 1px 0 rgba(0,0,0,.5)}
    .poster{height:100%;display:grid;place-items:center;font-weight:700;color:#fff;opacity:.95}
    .p0{background:linear-gradient(135deg,#1d2340,#44235a)}
    .p1{background:linear-gradient(135deg,#1f2242,#0b3b46)}
    .p2{background:linear-gradient(135deg,#211f42,#531a35)}
    /* Product grid */
    .grid{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:.75rem}
    @media (max-width: 1024px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
    @media (max-width: 640px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
    .pitem{border:1px solid var(--border);border-radius:10px;background:var(--panel);padding:.75rem;display:flex;flex-direction:column;gap:.4rem}
    .price{font-weight:600}
    /* Cart drawer */
    .drawer{position:fixed;right:0;top:0;height:100dvh;width:min(420px,100%);background:#0b0d14;border-left:1px solid var(--border);
      transform:translateX(100%);transition:transform .25s ease;z-index:40;display:flex;flex-direction:column}
    .drawer.open{transform:translateX(0)}
    .drawer header{display:flex;align-items:center;justify-content:space-between;padding:1rem;border-bottom:1px solid var(--border)}
    .drawer main{flex:1;overflow:auto;padding:1rem}
    .drawer footer{padding:1rem;border-top:1px solid var(--border)}
    /* Modal player */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.65);backdrop-filter:blur(4px);z-index:50}
    .modal.open{display:grid}
    .modal-card{width:min(900px,95vw);background:#0b0d14;border:1px solid var(--border);border-radius:12px;overflow:hidden}
    .modal-header{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;border-bottom:1px solid var(--border)}
    .video{aspect-ratio:16/9;background:#000;display:grid;place-items:center;color:#888}
    /* Rocket transition */
    .transition{pointer-events:none;position:fixed;inset:0;z-index:60;opacity:0;transition:opacity .15s ease}
    .transition.active{opacity:1}
    .plume{position:absolute;left:50%;transform:translateX(-50%);bottom:-20%;width:160vw;height:60vh;border-radius:50%;
      background:radial-gradient(ellipse at center, rgba(255,165,90,.9), rgba(255,135,60,.6) 50%, transparent 70%);
      filter:blur(18px);animation:rise .7s ease forwards}
    @keyframes rise { from{bottom:-40%;opacity:.3} to{bottom:120%;opacity:0} }
    /* Starfield canvas */
    #starfield{position:fixed;inset:0;z-index:-1;opacity:.7}
    /* Inputs */
    .input{background:transparent;border:1px solid var(--border);border-radius:.5rem;padding:.45rem .6rem;color:var(--text)}
    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .card:hover{transform:none}
      .plume{animation:none;display:none}
    }
  </style>
</head>
<body>
  <canvas id="starfield" aria-hidden="true"></canvas>

  <div class="navbar" role="navigation">
    <div class="nav-left">
      <a class="brand" href="#" data-route="home">ðŸš€ SpaceFlix</a>
      <a class="nav-link" href="#" data-route="home">Home</a>
      <a class="nav-link" href="#shop" data-route="shop">Shop</a>
      <span class="badge">Demo</span>
    </div>
    <div class="nav-right" style="display:flex;align-items:center;gap:.5rem">
      <input class="input" id="search" placeholder="Search..." aria-label="Search"/>
      <button class="btn-ghost btn" id="cartBtn" aria-haspopup="dialog" aria-controls="cartDrawer">Cart <span id="cartCount" class="badge" aria-live="polite">0</span></button>
      <button class="btn" id="signinBtn">Sign in</button>
    </div>
  </div>

  <div class="container">
    <section class="hero" aria-label="Featured">
      <div class="hero-slide slide0" style="opacity:1">
        <div>
          <h1>Explore the Cosmos</h1>
          <p class="muted">Binge epic tales. Shop stellar gear.</p>
        </div>
      </div>
      <div class="hero-slide slide1" style="opacity:0">
        <div>
          <h1>Orionâ€™s Belt</h1>
          <p class="muted">A rogue pilot outruns the event horizon.</p>
        </div>
      </div>
      <div class="hero-slide slide2" style="opacity:0">
        <div>
          <h1>Mango Habanero</h1>
          <p class="muted">Sweet heat. Supernova flavor.</p>
        </div>
      </div>
      <div class="hero-gradient"></div>
    </section>

    <section class="row" id="rails">
      <h2>Trending</h2>
      <div class="rail" id="rail-trending"></div>

      <h2 style="margin-top:1rem">For You</h2>
      <div class="rail" id="rail-foryou"></div>

      <h2 style="margin-top:1rem">New Releases</h2>
      <div class="rail" id="rail-new"></div>

      <h2 style="margin-top:1rem">By Genre: Sciâ€‘Fi</h2>
      <div class="rail" id="rail-scifi"></div>
    </section>

    <section class="row" id="shop" aria-label="Shop">
      <h2>Shop Rocket City Jerky</h2>
      <div class="grid" id="product-grid"></div>
    </section>
  </div>

  <!-- Cart Drawer -->
  <aside class="drawer" id="cartDrawer" role="dialog" aria-modal="true" aria-labelledby="cartTitle">
    <header>
      <h3 id="cartTitle">Your Cart</h3>
      <button class="btn-ghost btn" id="closeCartBtn" aria-label="Close cart">Close</button>
    </header>
    <main id="cartItems"></main>
    <footer>
      <div style="display:flex;align-items:center;justify-content:space-between">
        <strong>Total: $<span id="cartTotal">0.00</span></strong>
        <button class="btn" id="checkoutBtn" title="Simulated checkout">Checkout</button>
      </div>
      <p class="muted" style="color:var(--muted);margin:.5rem 0 0">Stripe Checkout integration omitted in singleâ€‘file demo.</p>
    </footer>
  </aside>

  <!-- Player Modal -->
  <div class="modal" id="playerModal" role="dialog" aria-modal="true" aria-labelledby="playerTitle">
    <div class="modal-card">
      <div class="modal-header">
        <strong id="playerTitle">Now Playing</strong>
        <button class="btn-ghost btn" id="closePlayerBtn" aria-label="Close player">Close</button>
      </div>
      <div class="video"><span>HLS player placeholder (demo)</span></div>
      <div style="padding:1rem">
        <p id="playerSynopsis" style="color:var(--muted)"></p>
      </div>
    </div>
  </div>

  <!-- Rocket Transition -->
  <div class="transition" id="transition"><div class="plume"></div></div>

  <script>
    /* Data (demo) */
    const contents = Array.from({length: 18}).map((_,i)=> ({
      id: "c"+i, slug: "title-"+i,
      title: ["Orion's Belt","Five Peppers Collide","Mango Habanero","Nebula Nights","Quantum Drift","Lunar Echoes","Solar Flare","Event Horizon","Starlight Voyage","Cosmic Rift","Asteroid Tango","Dark Matter","Galactic Relay","Ion Storm","Voyager's Lament","Red Dwarf Run","Martian Dawn","Eclipse Protocol"][i%18],
      genres: (i%2===0? ["Sciâ€‘Fi","Adventure"]: ["Action"]),
      posterClass: "p"+(i%3),
      synopsis: "Space epic about "+(i%2?"saving":"finding")+" home among the stars."
    }));

    const products = [
      ["Orion's Belt â€” Black Pepper (8oz)",12.99],
      ["Mango Habanero (12oz)",16.99],
      ["Five Peppers Collide (8oz)",14.99],
      ["Honey Sriracha (8oz)",13.99],
      ["Teriyaki Comet (8oz)",12.99],
      ["Galactic Garlic (12oz)",17.99],
      ["Cosmic Cajun (8oz)",13.99],
      ["Supernova BBQ (8oz)",14.99]
    ].map(([title, price],i)=>({id:"p"+i,title,price}));

    const $ = (q)=>document.querySelector(q);
    const $$ = (q)=>Array.from(document.querySelectorAll(q));

    /* Starfield */
    (function(){
      const c = document.getElementById('starfield');
      const ctx = c.getContext('2d');
      let w = c.width = innerWidth, h = c.height = innerHeight;
      const reduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
      const stars = Array.from({length: reduced? 80: 320}, ()=>({x:Math.random()*w,y:Math.random()*h,z:Math.random()*.5+.5}));
      addEventListener('resize',()=>{w=c.width=innerWidth; h=c.height=innerHeight;});
      function draw(){
        ctx.clearRect(0,0,w,h);
        ctx.fillStyle = '#fff';
        for(const s of stars){
          const sz = s.z * (reduced? .5: 1.2);
          ctx.globalAlpha = .7 * s.z;
          ctx.fillRect(s.x,s.y,sz,sz);
          s.x += .05 + s.z*.25; if(s.x>w) s.x=0;
        }
        if(!reduced) requestAnimationFrame(draw);
      }
      draw();
    })();

    /* Hero carousel */
    (function(){
      const slides = $$('.hero-slide'); let i=0;
      setInterval(()=>{
        slides[i].style.opacity=0;
        i=(i+1)%slides.length;
        slides[i].style.opacity=1;
      }, 5000);
    })();

    /* Rails render */
    function renderRails(){
      const t = contents.slice(0,6);
      const f = contents.slice(6,12);
      const n = contents.slice(12,18);
      const s = contents.filter(c=>c.genres.includes("Sciâ€‘Fi")).slice(0,6);
      function mount(id, arr){
        const el = document.getElementById(id);
        el.innerHTML = arr.map(c=>`
          <article class="card" tabindex="0" role="button" aria-label="Play ${c.title}" data-id="${c.id}">
            <div class="poster ${c.posterClass}"><span>${c.title}</span></div>
            <div class="label">${c.title}</div>
          </article>`).join('');
      }
      mount('rail-trending', t);
      mount('rail-foryou', f);
      mount('rail-new', n);
      mount('rail-scifi', s);
    }
    renderRails();

    /* Player modal */
    const playerModal = $('#playerModal');
    $('#closePlayerBtn').onclick = ()=> playerModal.classList.remove('open');
    document.getElementById('rails').addEventListener('click', (e)=>{
      const card = e.target.closest('.card');
      if(!card) return;
      const id = card.getAttribute('data-id');
      const item = contents.find(x=>x.id===id);
      if(!item) return;
      document.getElementById('playerTitle').textContent = item.title;
      document.getElementById('playerSynopsis').textContent = item.synopsis;
      playerModal.classList.add('open');
    });

    /* Products */
    function renderProducts(filter=""){
      const grid = $('#product-grid');
      const query = filter.toLowerCase();
      const list = products.filter(p=>p.title.toLowerCase().includes(query));
      grid.innerHTML = list.map(p=>`
        <div class="pitem" data-id="${p.id}">
          <div style="height:130px;border-radius:8px;background:linear-gradient(135deg,#1d2340,#44235a);display:grid;place-items:center;font-weight:700">Jerky</div>
          <div>${p.title}</div>
          <div class="price">$${p.price.toFixed(2)}</div>
          <button class="btn add">Add to Cart</button>
        </div>`).join('');
    }
    renderProducts();

    /* Search */
    document.getElementById('search').addEventListener('input', (e)=>{
      renderProducts(e.target.value);
    });

    /* Cart logic (localStorage) */
    const cartKey = 'spaceflix.cart';
    const cartBtn = $('#cartBtn');
    const cartDrawer = $('#cartDrawer');
    const cartItems = $('#cartItems');
    const cartTotal = $('#cartTotal');
    const cartCount = $('#cartCount');
    $('#closeCartBtn').onclick = ()=> cartDrawer.classList.remove('open');
    cartBtn.onclick = ()=> cartDrawer.classList.add('open');

    function loadCart(){ try{ return JSON.parse(localStorage.getItem(cartKey) || '[]'); }catch{return []} }
    function saveCart(items){ localStorage.setItem(cartKey, JSON.stringify(items)); updateCartUI(); }
    function addToCart(id){ const items=loadCart(); const found=items.find(x=>x.id===id);
      if(found) found.qty++; else items.push({id, qty:1});
      saveCart(items);
    }
    function removeFromCart(id){ let items=loadCart().filter(x=>x.id!==id); saveCart(items); }
    function updateCartUI(){
      const items = loadCart().map(it=>{
        const p = products.find(x=>x.id===it.id); return {...it, ...p};
      });
      cartItems.innerHTML = items.map(it=>`
        <div style="display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);padding:.5rem 0">
          <div><div>${it.title}</div><div class="badge">Qty: ${it.qty}</div></div>
          <div style="display:flex;align-items:center;gap:.5rem">
            <strong>$${(it.price*it.qty).toFixed(2)}</strong>
            <button class="btn-ghost btn" data-remove="${it.id}">Remove</button>
          </div>
        </div>
      `).join('');
      const total = items.reduce((s,it)=>s+it.price*it.qty,0);
      cartTotal.textContent = total.toFixed(2);
      const count = items.reduce((s,it)=>s+it.qty,0);
      cartCount.textContent = count;
    }
    updateCartUI();

    document.getElementById('product-grid').addEventListener('click', (e)=>{
      const add = e.target.closest('.add');
      if(!add) return;
      const card = e.target.closest('.pitem');
      addToCart(card.getAttribute('data-id'));
      document.getElementById('transition').classList.add('active');
      setTimeout(()=>document.getElementById('transition').classList.remove('active'), 500);
    });
    cartItems.addEventListener('click', (e)=>{
      const rm = e.target.getAttribute('data-remove');
      if(rm){ removeFromCart(rm) }
    });

    /* Fake checkout */
    document.getElementById('checkoutBtn').onclick = ()=>{
      alert('Checkout flow is simulated in this single-file demo. Use the full Next.js app for Stripe checkout.');
    };

    /* Route transition on nav links */
    $$('.nav-left a').forEach(a=>a.addEventListener('click', (e)=>{
      const id = a.getAttribute('data-route');
      if(id === 'shop'){
        document.getElementById('shop').scrollIntoView({behavior: (matchMedia('(prefers-reduced-motion: reduce)').matches?'auto':'smooth')});
      } else {
        scrollTo({top:0, behavior: (matchMedia('(prefers-reduced-motion: reduce)').matches?'auto':'smooth')});
      }
      e.preventDefault();
      const t = document.getElementById('transition');
      t.classList.add('active');
      setTimeout(()=> t.classList.remove('active'), 700);
    }));
  </script>
</body>
</html>